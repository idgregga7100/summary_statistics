#trying to get significant PhenomeXcan hits, replicate Elyse's results with PhenomeXcan traits
#figured out how to do it better!

#ex: JAZF1, ENSG00000153814

pvalues<-read.table("smultixcan-mashr-pvalues.tsv",header=TRUE,sep="\t"
jazf1<-pvalues%>%filter(gene_name=="ENSG00000153814")%>%gather(key="trait",value="pvalue")%>%arrange(pvalue)

#verticle 2-column table, traits in one column and p-values in the other
#still not reading e sci notation as numbers, reads as characters, so all p-values with e are at the bottom out of order



#this isn't efficient, but this is what I have so far
#ex: gene PRF1, ENSG00000180644
#in terminal, to get line number for this gene's row:
grep -n ENSG00000180644 smultixcan-mashr-pvalues.tsv
#line 13572 will be row 13571 in the R table
#in R:
pvalues<-read_tsv("smultixcan-mashr-pvalues.tsv")
prf1<-pvalues["13571",]
prf1_vert<-gather(prf1,key="trait",value="pvalues")
prf1_sort<-arrange(prf1_vert, desc(pvalues))
#sorting in descending order so that the p-values in E notation appear at the top of the table
#can't figure out how to sort taking E notation into account?
